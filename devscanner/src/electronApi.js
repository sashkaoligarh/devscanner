// Safe electron API wrapper â€” prevents crashes when window.electron is unavailable
const electron = {
  get available() { return !!window.electron },
  selectFolder: () => window.electron?.selectFolder?.() ?? Promise.resolve(null),
  scanFolder: (p) => window.electron?.scanFolder?.(p) ?? Promise.resolve({ success: false, error: 'Not available' }),
  launchProject: (o) => window.electron?.launchProject?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  stopProject: (o) => window.electron?.stopProject?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  getRunning: () => window.electron?.getRunning?.() ?? Promise.resolve({}),
  openBrowser: (u) => window.electron?.openBrowser?.(u),
  scanPorts: (o) => window.electron?.scanPorts?.(o) ?? Promise.resolve({ success: false, error: 'Restart Electron to enable port scanning' }),
  killPortProcess: (o) => window.electron?.killPortProcess?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  getSettings: () => window.electron?.getSettings?.() ?? Promise.resolve({}),
  saveSettings: (s) => window.electron?.saveSettings?.(s) ?? Promise.resolve({ success: true }),
  getHostInfo: () => window.electron?.getHostInfo?.() ?? Promise.resolve({ isWsl: false, wslIp: null }),
  checkWslLocalhost: () => window.electron?.checkWslLocalhost?.() ?? Promise.resolve({ available: false }),
  fixWslLocalhost: () => window.electron?.fixWslLocalhost?.() ?? Promise.resolve({ success: false }),
  getWslDistros: () => window.electron?.getWslDistros?.() ?? Promise.resolve([]),
  selectWslFolder: (d) => window.electron?.selectWslFolder?.(d) ?? Promise.resolve(null),
  onProjectLog: (cb) => window.electron?.onProjectLog?.(cb),
  onProjectStopped: (cb) => window.electron?.onProjectStopped?.(cb),
  onProjectPortChanged: (cb) => window.electron?.onProjectPortChanged?.(cb),
  removeProjectLogListener: () => window.electron?.removeProjectLogListener?.(),
  removeProjectStoppedListener: () => window.electron?.removeProjectStoppedListener?.(),
  removeProjectPortChangedListener: () => window.electron?.removeProjectPortChangedListener?.(),
  onUpdateAvailable: (cb) => window.electron?.onUpdateAvailable?.(cb),
  onUpdateDownloadProgress: (cb) => window.electron?.onUpdateDownloadProgress?.(cb),
  onUpdateDownloaded: (cb) => window.electron?.onUpdateDownloaded?.(cb),
  downloadUpdate: () => window.electron?.downloadUpdate?.() ?? Promise.resolve({ success: false }),
  installUpdate: () => window.electron?.installUpdate?.(),
  checkForUpdate: () => window.electron?.checkForUpdate?.() ?? Promise.resolve({ success: false }),
  removeUpdateListeners: () => window.electron?.removeUpdateListeners?.(),
  checkDocker: (o) => window.electron?.checkDocker?.(o) ?? Promise.resolve({ docker: false, compose: null }),
  gitInfo: (o) => window.electron?.gitInfo?.(o) ?? Promise.resolve(null),
  gitFetch: (o) => window.electron?.gitFetch?.(o) ?? Promise.resolve({ success: false }),
  gitPull: (o) => window.electron?.gitPull?.(o) ?? Promise.resolve({ success: false }),
  getNpmScripts: (o) => window.electron?.getNpmScripts?.(o) ?? Promise.resolve({ success: false }),
  runNpmScript: (o) => window.electron?.runNpmScript?.(o) ?? Promise.resolve({ success: false }),
  windowMinimize: () => window.electron?.windowMinimize?.(),
  windowMaximize: () => window.electron?.windowMaximize?.(),
  windowClose: () => window.electron?.windowClose?.(),
  windowIsMaximized: () => window.electron?.windowIsMaximized?.() ?? Promise.resolve(false),
  onWindowMaximized: (cb) => window.electron?.onWindowMaximized?.(cb),
  removeWindowListeners: () => window.electron?.removeWindowListeners?.(),
  dockerListContainers: (o) => window.electron?.dockerListContainers?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  dockerContainerAction: (o) => window.electron?.dockerContainerAction?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  dockerStreamLogs: (o) => window.electron?.dockerStreamLogs?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  dockerStopLogs: (o) => window.electron?.dockerStopLogs?.(o) ?? Promise.resolve({ success: false }),
  readEnvFile: (o) => window.electron?.readEnvFile?.(o) ?? Promise.resolve({ success: false }),
  saveEnvFile: (o) => window.electron?.saveEnvFile?.(o) ?? Promise.resolve({ success: false }),
  listEnvFiles: (o) => window.electron?.listEnvFiles?.(o) ?? Promise.resolve({ success: false }),
  dockerServicesCatalog: () => window.electron?.dockerServicesCatalog?.() ?? Promise.resolve({ success: false }),
  dockerServicesConfig: (o) => window.electron?.dockerServicesConfig?.(o) ?? Promise.resolve({ success: false }),
  dockerServicesSave: (o) => window.electron?.dockerServicesSave?.(o) ?? Promise.resolve({ success: false }),
  dockerServicesStart: (o) => window.electron?.dockerServicesStart?.(o) ?? Promise.resolve({ success: false }),
  dockerServicesStop: (o) => window.electron?.dockerServicesStop?.(o) ?? Promise.resolve({ success: false }),
  dockerServicesStatus: (o) => window.electron?.dockerServicesStatus?.(o) ?? Promise.resolve({ success: false }),
  dockerServicesInjectEnv: (o) => window.electron?.dockerServicesInjectEnv?.(o) ?? Promise.resolve({ success: false }),
  onDockerServicesHealth: (cb) => window.electron?.onDockerServicesHealth?.(cb),
  removeDockerServicesHealthListener: () => window.electron?.removeDockerServicesHealthListener?.(),
  sshConnect: (o) => window.electron?.sshConnect?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshDisconnect: (o) => window.electron?.sshDisconnect?.(o) ?? Promise.resolve({ success: false }),
  sshDiscover: (o) => window.electron?.sshDiscover?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshExec: (o) => window.electron?.sshExec?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshSaveServer: (o) => window.electron?.sshSaveServer?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshDeleteServer: (o) => window.electron?.sshDeleteServer?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshGetServers: () => window.electron?.sshGetServers?.() ?? Promise.resolve({ success: false, data: [] }),
  onDockerLog: (cb) => window.electron?.onDockerLog?.(cb),
  onDockerLogEnd: (cb) => window.electron?.onDockerLogEnd?.(cb),
  removeDockerLogListeners: () => window.electron?.removeDockerLogListeners?.(),
  // Phase 3: Remote project launch
  sshAnalyzeProject: (o) => window.electron?.sshAnalyzeProject?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshLaunchProject: (o) => window.electron?.sshLaunchProject?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshStopProject: (o) => window.electron?.sshStopProject?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshGetRemoteRunning: (o) => window.electron?.sshGetRemoteRunning?.(o) ?? Promise.resolve({ success: false, data: {} }),
  onRemoteProjectLog: (cb) => window.electron?.onRemoteProjectLog?.(cb),
  removeRemoteProjectLogListener: () => window.electron?.removeRemoteProjectLogListener?.(),
  onRemoteProjectStopped: (cb) => window.electron?.onRemoteProjectStopped?.(cb),
  removeRemoteProjectStoppedListener: () => window.electron?.removeRemoteProjectStoppedListener?.(),
  // Phase 4: Nginx manager
  sshNginxList: (o) => window.electron?.sshNginxList?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshNginxRead: (o) => window.electron?.sshNginxRead?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshNginxSave: (o) => window.electron?.sshNginxSave?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshNginxEnable: (o) => window.electron?.sshNginxEnable?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshNginxDisable: (o) => window.electron?.sshNginxDisable?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshNginxDelete: (o) => window.electron?.sshNginxDelete?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshNginxTest: (o) => window.electron?.sshNginxTest?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshNginxReload: (o) => window.electron?.sshNginxReload?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshNginxInstall: (o) => window.electron?.sshNginxInstall?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshCertbotInstall: (o) => window.electron?.sshCertbotInstall?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshCertbotRun: (o) => window.electron?.sshCertbotRun?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  // Phase 6: Service management
  sshPm2Action: (o) => window.electron?.sshPm2Action?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshPm2Logs: (o) => window.electron?.sshPm2Logs?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshDockerAction: (o) => window.electron?.sshDockerAction?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshDockerLogs: (o) => window.electron?.sshDockerLogs?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshSystemdAction: (o) => window.electron?.sshSystemdAction?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshSystemdLogs: (o) => window.electron?.sshSystemdLogs?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  // Phase 5: Quick deploy
  sshQuickDeploy: (o) => window.electron?.sshQuickDeploy?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshFullDeploy: (o) => window.electron?.sshFullDeploy?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshRemoveProject: (o) => window.electron?.sshRemoveProject?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshUndeploy: (o) => window.electron?.sshUndeploy?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  sshUploadFolder: (o) => window.electron?.sshUploadFolder?.(o) ?? Promise.resolve({ success: false, error: 'Not available' }),
  selectDeployFolder: () => window.electron?.selectDeployFolder?.() ?? Promise.resolve(null),
  onUploadProgress: (cb) => window.electron?.onUploadProgress?.(cb),
  removeUploadProgressListener: () => window.electron?.removeUploadProgressListener?.(),
  onDeployLog: (cb) => window.electron?.onDeployLog?.(cb),
  removeDeployLogListener: () => window.electron?.removeDeployLogListener?.(),
}

export default electron
